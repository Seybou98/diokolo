(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[776],{37948:function(e,n,i){Promise.resolve().then(i.bind(i,76231))},76231:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return _}});var r=i(57437),s=i(99240),o=i(74340),t=i(6348),l=i(19651),a=i(64973);function c(e){let{src:n,size:i=90,...s}=e;return(0,r.jsx)(l.M,{w:"".concat(i,"px"),minW:"".concat(i,"px"),h:"".concat(i,"px"),minH:"".concat(i,"px"),rounded:"full",overflow:"hidden",...s,children:n?(0,r.jsx)(a.E,{src:n,w:"full",h:"full",objectFit:"cover",alt:"Profile picture"}):(0,r.jsx)(a.E,{src:"/icons/espace_client.png",w:"full",h:"full",objectFit:"cover",alt:"Default profile picture"})})}var d=i(78778),u=i(20610),f=i(40191),m=i(89386),h=i(14937),p=i(87138),x=i(16463);let j=[{title:"Nous \xe9crire",href:"mailto:".concat(d.xK),icon:"enveloppe.png"},{title:"Nous appeler",href:"tel:".concat(d.wv),icon:"telephone.png"}],g=[{name:"Mes informations",href:"/app/mon-compte/mes-informations"},{name:"Mes dossiers",href:"/app/mon-compte/mes-dossiers"}],b=[{name:"Blog",href:"/app/mon-compte/admin/articles"},{name:"Dossiers",href:"/app/mon-compte/admin/dossiers"}];function w(e){let{onClick:n,...i}=e,{user:l,logOut:d}=(0,t.b)(),w=(0,x.usePathname)(),k=(0,u.p)();if(!l)return null;function v(e){let{href:i,...s}=e;return(0,r.jsx)(f.x,{as:p.default,href:i,color:"gray.400",fontWeight:"800",...w&&w.includes(i)&&{color:"white"},onClick:n,...s})}return(0,r.jsxs)(s.k,{flexDir:"column",bg:"king",w:"full",p:{base:3,md:5},...i,children:[(0,r.jsxs)(m.U,{display:{base:"none",md:"flex"},children:[(0,r.jsx)(c,{src:l.photo}),(0,r.jsxs)(o.xu,{ml:3,children:[(0,r.jsx)(f.x,{color:"gray.400",fontSize:13,children:"Bonjour"}),(0,r.jsx)(f.x,{color:"white",fontWeight:800,fontSize:18,wordBreak:"break-all",children:l.firstName})]})]}),(0,r.jsx)(h.g,{mt:{base:10,md:20},align:"stretch",flex:1,children:(l.isAdmin?b:g).map((e,n)=>(0,r.jsx)(v,{href:e.href,children:e.name},n))}),(0,r.jsx)(h.g,{children:j.map((e,i)=>(0,r.jsxs)(s.k,{as:p.default,bg:"white",href:e.href,w:"full",rounded:"md",px:3,py:3,alignItems:"center",onClick:n,children:[(0,r.jsx)(a.E,{src:"/icons/".concat(e.icon),h:"25px",mx:5}),(0,r.jsx)(f.x,{w:"full",fontWeight:500,children:e.title})]},i))}),(0,r.jsx)(p.default,{href:"/",onClick:n,children:(0,r.jsx)(a.E,{src:"/logo_blanc.png",w:"200px",mx:"auto",mt:20})}),(0,r.jsx)(f.x,{textDecorationLine:"underline",textAlign:"center",mt:10,color:"gray.300",onClick:()=>{null==n||n(),d(),k({title:"Vous avez \xe9t\xe9 d\xe9connect\xe9 avec succ\xe8s",status:"success",position:"top"})},cursor:"pointer",children:"Se d\xe9connecter"})]})}var k=i(4566),v=i(51464),y=i(56206),E=i(1371),S=i(22601),C=i(86493);function D(e){let{...n}=e,{isOpen:i,onOpen:l,onClose:d}=(0,v.q)(),{user:u}=(0,t.b)();return u?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.k,{as:"header",position:"sticky",top:0,w:"full",justifyContent:"space-between",alignItems:"center",px:5,py:2,bg:"white",zIndex:999,...n,children:[(0,r.jsxs)(m.U,{w:"fit-content",children:[(0,r.jsx)(c,{src:null==u?void 0:u.photo,size:60}),(0,r.jsxs)(o.xu,{ml:3,children:[(0,r.jsx)(f.x,{color:"gray.500",fontSize:13,children:"Bonjour"}),(0,r.jsx)(f.x,{color:"king",fontWeight:800,fontSize:18,wordBreak:"break-all",children:u.firstName})]})]}),(0,r.jsx)(a.E,{src:"/icons/menu.svg",boxSize:"55px",p:3,mr:-3,cursor:"pointer",onClick:l})]}),(0,r.jsxs)(y.d,{isOpen:i,placement:"right",onClose:d,children:[(0,r.jsx)(E.Z,{}),(0,r.jsxs)(S.s,{maxW:"300px",children:[(0,r.jsx)(C.o,{color:"white"}),(0,r.jsx)(w,{flex:1,onClick:()=>d()})]})]})]}):null}var I=i(67016),R=i(2265),U=i(17564);let z=[{name:"Mes informations",href:"/app/mon-compte/mes-informations"},{name:"Mes dossiers",href:"/app/mon-compte/mes-dossiers"}],A=[{name:"Blog",href:"/app/mon-compte/admin/articles"},{name:"Dossiers",href:"/app/mon-compte/admin/dossiers"}];function _(e){let{children:n}=e,{data:i,isLoading:t}=(0,k.Pi)(),l=(0,x.useRouter)(),a=(0,x.usePathname)(),c=(0,R.useRef)(!1),[d,u]=(0,R.useState)({isReady:!1,firebaseUser:null,error:null});return((0,R.useEffect)(()=>{console.log("D\xe9marrage de la surveillance auth Firebase");let e=!0,n=U.I.onAuthStateChanged(async n=>{if(e){if(console.log("\xc9tat Firebase d\xe9taill\xe9:",{connectÃ©:!!n,uid:null==n?void 0:n.uid,token:n?await n.getIdToken():null,timestamp:new Date().toISOString()}),n)try{await n.getIdToken(!0)}catch(e){console.error("Erreur de rafra\xeechissement du token:",e)}u({isReady:!0,firebaseUser:n,error:null})}},n=>{e&&(console.error("Erreur d\xe9taill\xe9e Firebase Auth:",{message:n.message,code:n instanceof Error?n.name:"UnknownError",timestamp:new Date().toISOString()}),u({isReady:!0,firebaseUser:null,error:n}))});return()=>{e=!1,n()}},[]),(0,R.useEffect)(()=>{var e;if(d.isReady){if(!d.firebaseUser&&!c.current){c.current=!0,console.log("Redirection vers connexion - utilisateur non authentifi\xe9"),l.replace("/app/connexion");return}!t&&i&&(console.log("V\xe9rification des permissions:",{estAdmin:i.isAdmin,chemin:a,uid:null===(e=d.firebaseUser)||void 0===e?void 0:e.uid}),a.includes("/admin")&&!i.isAdmin?l.replace(z[0].href):!a.includes("/admin")&&i.isAdmin&&l.replace(A[0].href))}},[d.isReady,d.firebaseUser,i,t,a]),!d.isReady||t)?(0,r.jsx)(I.Z,{h:"100vh",children:"Initialisation de l'application..."}):d.firebaseUser&&i?(0,r.jsxs)(s.k,{h:{md:"100vh"},flexDir:{base:"column",md:"row"},children:[(0,r.jsx)(w,{display:{base:"none",md:"flex"},w:"300px"}),(0,r.jsx)(D,{display:{base:"flex",md:"none"}}),(0,r.jsx)(o.xu,{w:"full",maxH:"100vh",overflowY:{md:"auto"},children:n})]}):(0,r.jsx)(I.Z,{h:"100vh",children:"V\xe9rification des acc\xe8s..."})}}},function(e){e.O(0,[351,335,744],function(){return e(e.s=37948)}),_N_E=e.O()}]);