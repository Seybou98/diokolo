(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[578],{67342:function(e,t,n){Promise.resolve().then(n.bind(n,84661))},84661:function(e,t,n){"use strict";n.d(t,{default:function(){return ex}});var r=n(57437),i=n(74340),s=n(99240),o=n(86857),l=n(40191),c=n(9747),a=n(39343);let d=["Logement","\xc9quipement","Coordonn\xe9es","Adresse","Rendez-vous","Contrat","Paiement"];function u(e){var t;let{step:n,type:s,onChangeStep:u}=e,x=(null!==(t=(0,a.Gc)().watch("payment-type"))&&void 0!==t?t:"month")=="month"?"mensuelle":"annuelle";return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i.xu,{bg:"gray.200",w:"full",p:{base:5,lg:10},overflowX:"auto",children:[(0,r.jsx)(o.E,{justify:"center",children:d.map((e,t)=>(0,r.jsx)(o.U,{minW:"120px",w:{lg:"calc(".concat(100/d.length,"% - 10px)")},children:(0,r.jsxs)(l.x,{color:"gray.400",fontWeight:600,textAlign:"center",w:"full",...t==n&&{color:"king",fontWeight:800},...t<n&&{cursor:"pointer",onClick:()=>u(t)},fontSize:{base:12,lg:13,"2xl":16},children:["0",t+1,". ",e]})},t))}),(0,r.jsx)(i.xu,{bg:"gray.300",rounded:"full",h:2,mt:{base:5,md:10},children:(0,r.jsx)(i.xu,{h:"full",transition:"width .4s",w:n==d.length-1?"full":"".concat(100/d.length*(n+1)-50/d.length,"%"),bg:"primary",rounded:"full"})})]}),(0,r.jsx)(i.xu,{w:"full",bg:"king",py:"50px",children:(0,r.jsxs)(c.Z,{display:"flex",justifyContent:"space-between",color:"white",alignItems:"center",flexDir:{base:"column",lg:"row"},children:[(0,r.jsxs)(l.x,{fontSize:30,fontWeight:700,children:["Offre ",x," ",s.label," ","custom"!=s.type&&"PAC"]}),(0,r.jsxs)(l.x,{fontSize:14,children:["Offre ",x,", r\xe9silliable \xe0 tout moment"]})]})})]})}var x=n(2265);let p=["Un contrat adapt\xe9 \xe0 vos besoins et un suivi sur-mesure de votre \xe9quipement.","Des interventions rapide avec notre couverture nationale","Des conseillers et techniciens experts \xe0 votre \xe9coute."];function h(){return(0,r.jsx)(s.k,{justifyContent:"space-between",mt:20,children:p.map((e,t)=>(0,r.jsx)(l.x,{maxW:"270px",fontSize:13,textAlign:"center",children:e},t))})}var m=n(7232);function f(e){let{...t}=e;return(0,r.jsx)(i.xu,{w:"full",h:"1px",bg:"gray.200",my:3,...t})}var g=n(91518),j=n(13415);function b(e){var t;let{contractLabel:n,products:o,totalPrice:c}=e,d=(0,a.Gc)(),u=null!==(t=d.watch("payment-type"))&&void 0!==t?t:"month",x=d.watch("adresse"),p=d.watch("date");return(0,r.jsxs)(i.xu,{w:"full",maxW:"370px",borderWidth:1,borderColor:"king",bg:"white",px:7,py:4,mt:{base:5,lg:0},color:"king",h:"fit-content",children:[(0,r.jsx)(l.x,{fontWeight:700,fontSize:20,children:"Votre panier"}),(0,r.jsx)(f,{}),(0,r.jsxs)(s.k,{justifyContent:"space-between",children:[(0,r.jsx)(l.x,{children:"Total"}),(0,r.jsxs)(i.xu,{textAlign:"right",children:[(0,r.jsxs)(l.x,{fontWeight:700,children:[(0,m.x)(c)," TTC/mois"]}),(0,r.jsxs)(l.x,{children:["Soit ",(0,m.x)(12*c)," TTC/an"]})]})]}),(0,r.jsxs)(s.k,{justifyContent:"space-between",mt:5,children:[(0,r.jsx)(l.x,{children:"TVA"}),(0,r.jsx)(l.x,{fontWeight:200,children:"5,5%"})]}),(0,r.jsx)(f,{}),(0,r.jsxs)(i.xu,{children:[(0,r.jsxs)(s.k,{justifyContent:"space-between",children:[(0,r.jsxs)(i.xu,{children:[(0,r.jsx)(l.x,{children:"Formule"}),(0,r.jsx)(l.x,{mb:2,children:n})]}),(0,r.jsxs)(i.xu,{textAlign:"right",fontSize:13,mt:1,children:[(0,r.jsxs)(l.x,{children:[(0,m.x)(c)," TTC/mois"]}),(0,r.jsxs)(l.x,{children:["Soit ",(0,m.x)(12*c)," TTC/an"]})]})]}),o.map(e=>(0,r.jsxs)(l.x,{fontSize:13,noOfLines:1,children:["- ",e.name]},e.id))]}),(0,r.jsxs)(s.k,{bg:"secondary",px:3,py:2,justifyContent:"space-between",my:5,color:"white",fontWeight:600,alignItems:"center",children:[(0,r.jsx)(l.x,{fontSize:18,children:"TOTAL CONTRAT"}),(0,r.jsxs)(l.x,{fontSize:13,children:[(0,m.x)(c*("month"==u?1:12))," TTC/","month"==u?"mois":"an"]})]}),x&&p&&(0,r.jsxs)(i.xu,{bg:"secondaryLight",rounded:"md",px:7,py:4,children:[(0,r.jsx)(l.x,{children:"Votre rendez-vous temporaire"}),(0,r.jsx)(l.x,{mt:5,fontWeight:700,children:function(e){let{address:t,city:n,zipCode:r,address2:i}=e;return"".concat(t).concat(i?" ".concat(i):"",", ").concat(r," ").concat(n)}(x)}),(0,r.jsx)(l.x,{mt:3,fontWeight:700,textTransform:"capitalize",children:(0,g.p6)(new Date(p.split("|")[0]),"EEEE dd MMMM yyyy",{locale:j.fr})}),(0,r.jsx)(l.x,{mt:3,fontWeight:700,children:p.split("|")[1]})]})]})}var y=n(89386),v=n(64973),w=n(14937),C=n(83556),S=n(36427),k=n(410),E=n(19769),z=n(19651),W=n(70671),T=n(63680),I=n(20864);function A(e){let{children:t,label:n}=e;return(0,r.jsxs)(i.xu,{children:[n&&(0,r.jsx)(I.l,{fontSize:13,color:"king",fontWeight:600,children:n}),t]})}let M=(0,x.forwardRef)((e,t)=>{let{label:n,options:i,isRequired:s,name:o}=e,c=(0,T.qk)(o),{watch:d,setValue:u}=(0,a.Gc)(),[p,h]=(0,x.useState)(d(o)||"");return(0,r.jsx)(E.NI,{isInvalid:!!c,isRequired:s,ref:t,children:(0,r.jsxs)(A,{label:n,children:[(0,r.jsx)(y.U,{spacing:4,align:"stretch",children:i.map(e=>(0,r.jsx)(z.M,{onClick:()=>{var t;h(t=e.id),u(o,t)},p:4,borderWidth:"2px",borderRadius:"md",borderColor:p===e.id?"secondary":"gray.200",bg:"white",flex:1,maxW:"180px",cursor:"pointer",children:(0,r.jsx)(l.x,{textAlign:"center",color:"king",children:e.title})},e.id))}),c&&(0,r.jsx)(W.J1,{children:c.message})]})})});M.displayName="MaintenanceSelect";var R=n(33596),D=n(24896),_=n(80806),U=n(48724),L=n(3107),q=n(72781),P=n(33673),V=n(25055);let F=(0,x.forwardRef)((e,t)=>{let{isRequired:n,name:o}=e,c=(0,T.qk)(o),{watch:d,setValue:u}=(0,a.Gc)(),[p,h]=(0,x.useState)(d(o)||""),m=(0,x.useMemo)(()=>O(),[]);return(0,r.jsxs)(E.NI,{isInvalid:!!c,isRequired:n,ref:t,children:[(0,r.jsx)(i.xu,{borderWidth:"1px",borderRadius:"md",overflow:"hidden",overflowX:"auto",maxW:{base:"270px",sm:"full"},mx:{base:"auto"},children:(0,r.jsx)(s.k,{children:m.map(e=>{let t=(0,g.WU)(e.date,"yyyy-MM-dd");return(0,r.jsxs)(i.xu,{flex:"1",children:[(0,r.jsxs)(i.xu,{bg:"#9ce2fb",color:"king",p:2,textAlign:"center",children:[(0,r.jsx)(l.x,{children:(0,V.kC)((0,g.WU)(e.date,"EEEE",{locale:j.fr}))}),(0,r.jsx)(l.x,{fontSize:{base:"11px",sm:"sm"},children:(0,V.kC)((0,g.WU)(e.date,"dd MMM",{locale:j.fr}))})]}),(0,r.jsx)(s.k,{flexDirection:"column",p:2,children:e.timeslots.map(e=>{let n="".concat(t,"|").concat(e);return(0,r.jsx)(i.xu,{onClick:()=>{h(n),u(o,n)},py:1,my:1,mx:"auto",textAlign:"center",borderWidth:2,borderRadius:"md",w:"70px",borderColor:p===n?_.O.secondary:"gray.200",cursor:"pointer",fontSize:13,children:e},e)})})]},e.date.toISOString())})})}),c&&(0,r.jsx)(W.J1,{children:c.message})]})}),O=()=>{let e=new Date,t=(0,U.$)((0,L.z)(e,2)),n=(0,q.E)(t,4);return(0,P.D)({start:t,end:n}).map(e=>({date:e,timeslots:["8h - 12h","14h - 18h"]}))};var N=n(17564),J=n(25524),G=n(93191),Z=n(16463),X=n(17121),B=n(9453),Q=n(16829),H=n(18755),K=n(87138),$=(0,x.forwardRef)((e,t)=>{let{products:n,onSubmit:s,type:o}=e,{watch:c,setValue:d,getValues:u}=(0,a.Gc)(),{mutate:p,isPending:h}=(0,J.useMutation)({mutationFn:async e=>{let t=await (0,X.ET)((0,X.hJ)(N.db,"maintenance_contracts"),{...e,status:"pending",createdAt:new Date});return{recipientViewUrl:"".concat(window.location.origin,"/contracts/").concat(t.id,"/view"),docUrl:"".concat(window.location.origin,"/contracts/").concat(t.id,"/document"),envelopeId:t.id}}}),[m,f]=(0,x.useState)(""),g=c("unsignedDocUrl"),j=c("recipientViewUrl");function b(e){if("signedContract"===e.key){var t;f(null!==(t=e.newValue)&&void 0!==t?t:"")}}(0,x.useEffect)(()=>(m||p({currentForm:u(),productIds:n.map(e=>e.id),type:o},{onSuccess(e){let{recipientViewUrl:t,docUrl:n,envelopeId:r}=e;d("recipientViewUrl",t),d("unsignedDocUrl",n),d("envelopeId",r)}}),window.addEventListener("storage",b),()=>{window.removeEventListener("storage",b)}),[m]);let y=u("contractCheckbox1"),C=u("contractCheckbox2");return(0,r.jsxs)(i.xu,{position:"relative",children:[h&&(0,r.jsx)(Q.$,{position:"absolute",left:"calc(50% - 50px)",top:10,boxSize:"100px",color:"primary"}),(0,r.jsxs)(i.xu,{visibility:j&&g&&!h?"visible":"hidden",children:[!m&&(0,r.jsxs)(z.M,{flexDir:"column",bg:"#9ce2fb",p:5,color:"king",fontSize:18,rounded:"md",children:[(0,r.jsx)(v.E,{src:"/icons/maison_securisee.png",h:"60px"}),(0,r.jsx)(l.x,{fontWeight:600,my:2,children:"Mon contrat d'entretien"}),(0,r.jsx)(w.g,{children:n.map(e=>(0,r.jsx)(l.x,{children:e.name},e.id))}),(0,r.jsx)(R.default,{my:5,h:"55px",href:g,target:"_blank",children:"Visualiser mon contrat"})]}),m?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.x,{fontSize:11,textAlign:"center",mt:10,children:'En cliquant sur "Proc\xe9der au paiement", je confirme ma souscription et m\'engage \xe0 r\xe9gler les factures correspondant au contrat'}),(0,r.jsx)(R.default,{h:"55px",mx:"auto",mt:10,isDisabled:!y||!C,onClick:()=>{localStorage.setItem("signedContract",""),s()},children:"Proc\xe9der au paiement"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(w.g,{mt:10,align:"stretch",children:[(0,r.jsx)(H.X,{size:"lg",isChecked:y,onChange:e=>d("contractCheckbox1",e.currentTarget.checked),children:(0,r.jsx)(l.x,{ml:4,children:"J'ai pris connaissance de mon contrat et pi\xe8ces annexes ci-dessus"})}),(0,r.jsx)(H.X,{size:"lg",isChecked:C,onChange:e=>d("contractCheckbox2",e.currentTarget.checked),children:(0,r.jsxs)(l.x,{ml:4,children:["J'ai pris connaissance des"," ",(0,r.jsx)(l.x,{as:K.default,href:"/mentions-legales",color:"secondary",textDecorationLine:"underline",children:"conditions g\xe9n\xe9rales de vente et de leur(s) annexe(s)"})," "]})})]}),(0,r.jsx)(R.default,{h:"55px",mx:"auto",mt:10,isDisabled:!y||!C,href:j,target:"_blank",children:"Signer mon contrat"})]})]})]})}),Y=n(20610),ee=n(13537),et=n(7345),en=n(13259);let er=(0,ee.J)(en.t.STRIPE_KEY_TEST),ei=(0,x.forwardRef)((e,t)=>{let{type:n,products:s}=e,o=(0,et.useStripe)(),c=(0,et.useElements)(),d=(0,Y.p)(),{watch:u,register:p,getValues:h}=(0,a.Gc)(),{mutate:m}=(0,J.useMutation)({mutationFn:async e=>({subscriptionId:(await (0,X.ET)((0,X.hJ)(N.db,"subscriptions"),{...e,status:"pending",createdAt:new Date})).id,status:"pending"})}),{mutate:f}=function(){let e=(0,G.useQueryClient)();return(0,J.useMutation)({mutationFn:async e=>(await (0,X.r7)((0,X.JU)(N.db,"maintenance_contracts",e.envelopeId),{status:"signed",signedAt:new Date}),{docUrl:"".concat(window.location.origin,"/contracts/").concat(e.envelopeId,"/document")}),onSuccess(){e.invalidateQueries({queryKey:B.Wg.list()})}})}(),g=(0,Z.useRouter)(),[j,b]=(0,x.useState)(!1),[y,v]=(0,x.useState)(!1),w=u("payment-type");async function C(){if(!o||!c)return;b(!0);let e=c.getElement(et.IbanElement);if(!e)return b(!1),null;let t=h("email"),r=h("prenom")+" "+h("nom"),{error:i,paymentMethod:l}=await o.createPaymentMethod({type:"sepa_debit",sepa_debit:e,billing_details:{email:t,name:r}});if(i){d({title:"Erreur lors de la cr\xe9ation de la m\xe9thode de paiement",description:i.message,status:"error",position:"top",duration:4e3}),b(!1);return}let a=l.id;m({interval:w,contract:{productIds:s.map(e=>e.id),type:n},paymentMethodId:a,email:t},{async onSuccess(e){var t,n;let{error:r}=await o.confirmSepaDebitPayment(null==e?void 0:null===(n=e.latest_invoice)||void 0===n?void 0:null===(t=n.payment_intent)||void 0===t?void 0:t.client_secret,{payment_method:a});r?(d({title:"Impossible d'activer l'abonnement",description:r.message,status:"error",position:"top",duration:4e3}),b(!1)):f({envelopeId:h("envelopeId")},{onSuccess(){d({title:"Abonnement activ\xe9",description:"Vous allez \xeatre redirig\xe9 vers votre espace client",status:"success",position:"top",duration:4e3}),g.push("/app/mon-compte/mes-contrats")},onSettled(){b(!1)}})},onError(e){d({title:"Impossible de cr\xe9er l'abonnement",description:e.message,status:"error",position:"top",duration:4e3}),b(!1)}})}return(0,r.jsxs)(i.xu,{children:[(0,r.jsx)(M,{options:[{title:"Mensuel",id:"month"},{title:"Annuel",id:"year"}],...p("payment-type")}),w&&(0,r.jsx)(i.xu,{w:"full",bg:"gray.100",rounded:"md",px:7,py:2,mt:4,children:(0,r.jsxs)(l.x,{children:["Vous allez \xeatre pr\xe9lev\xe9 une fois par"," ","month"==w?"mois":"an","."," "]})}),(0,r.jsx)(l.x,{textAlign:"center",fontSize:25,fontWeight:600,my:7,children:"Pr\xe9l\xe8vement"}),(0,r.jsx)(i.xu,{borderWidth:2,borderColor:"gray.200",rounded:"md",py:3,px:2,children:(0,r.jsx)(et.IbanElement,{onChange:e=>{v(e.complete)},options:{supportedCountries:["SEPA"],placeholderCountry:"FR",style:{base:{fontSize:"18px",":focus":{backgroundColor:"white"}}}}})}),(0,r.jsx)(l.x,{children:"IBAN de test : DE89370400440532013000"}),(0,r.jsx)(l.x,{my:10,children:"Paiement s\xe9curis\xe9 avec cryptage SSL"}),(0,r.jsx)(R.default,{onClick:()=>C(),mx:"auto",h:"55px",px:10,isLoading:j,isDisabled:!y||!w,children:"Valider"}),(0,r.jsx)(l.x,{mt:10,fontWeight:200,children:"En cliquant sur \xab Payer \xbb, vous autorisez Label Energie \xe0 envoyer des instructions \xe0 votre banque pour d\xe9biter votre compte, et votre banque \xe0 d\xe9biter votre compte conform\xe9ment aux instructions de Label Energie. Vous b\xe9n\xe9ficiez du droit d’\xeatre rembours\xe9 par votre banque selon les conditions d\xe9crites dans la convention que vous avez pass\xe9e avec elle. Une demande de remboursement doit \xeatre pr\xe9sent\xe9e dans les 8 semaines suivant la date de d\xe9bit de votre compte pour un pr\xe9l\xe8vement autoris\xe9"})]})});function es(e){let{onNext:t,currentTree:{items:n,title:i,subtitle:s,hideButton:o},products:c,contractType:d,onPrevious:u}=e,p=(0,a.Gc)(),h=(0,x.useMemo)(()=>{let e=n.filter(e=>!e.notRequired).map(e=>e.id),t=p.getValues(),r=!1;return e.forEach(e=>{if(!t[e]){r=!0;return}}),r},[p.watch(),n]);return(0,r.jsxs)(C.Z,{w:"full",maxW:"570px",mr:{lg:5},p:{base:3,md:7},h:"fit-content",position:"relative",children:[u&&(0,r.jsxs)(y.U,{cursor:"pointer",onClick:u,position:{md:"absolute"},top:4,left:4,children:[(0,r.jsx)(v.E,{src:"/icons/caret.svg",h:"25px"}),(0,r.jsx)(l.x,{color:"primary",fontWeight:600,children:"Retour"})]}),(0,r.jsx)(l.x,{textAlign:"center",fontWeight:600,fontSize:18,children:i}),(0,r.jsx)(S.Z,{zoom:!1,mt:3,mb:7}),s&&(0,r.jsx)(l.x,{mb:7,textAlign:"center",fontSize:13,children:s}),(0,r.jsx)(w.g,{spacing:5,align:"stretch",children:n.map(e=>{let{id:n,type:i,placeholder:s,title:o,values:l}=e;return(0,r.jsxs)(x.Fragment,{children:["input"==i&&(0,r.jsx)(A,{label:o,children:(0,r.jsx)(k.I,{label:s,...p.register(n)})}),"select"==i&&(0,r.jsx)(M,{options:null!=l?l:[],label:o,...p.register(n)}),"input-address"==i&&(0,r.jsx)(A,{label:o,children:(0,r.jsx)(D.r,{...p.register(n)})}),"input-date"==i&&(0,r.jsx)(F,{...p.register(n)}),"input-contract"==i&&(0,r.jsx)($,{products:c,onSubmit:t,type:d,...p.register(n)}),"input-payment"==i&&(0,r.jsx)(et.Elements,{stripe:er,children:(0,r.jsx)(ei,{products:c,type:d,...p.register(n)})})]},n)})}),!o&&(0,r.jsx)(R.default,{h:"55px",mx:"auto",mt:10,isDisabled:h,onClick:()=>t(p.getValues()),children:"Continuer"})]})}var eo=n(54448),el=n(51464),ec=(0,x.forwardRef)((e,t)=>{let{}=e,{isOpen:n,onOpen:o,onClose:c}=(0,el.q)();return(0,x.useImperativeHandle)(t,()=>({onOpen:()=>{o()}})),(0,r.jsx)(eo.Z,{isOpen:n,onClose:c,size:"3xl",children:(0,r.jsxs)(w.g,{flexDir:{base:"column",lg:"row"},spacing:8,overflowX:"hidden",children:[(0,r.jsx)(i.xu,{borderWidth:1,borderRadius:"lg",w:"50%",children:(0,r.jsxs)(w.g,{align:"stretch",spacing:0,children:[(0,r.jsx)(l.x,{fontSize:"lg",fontWeight:"bold",textAlign:"center",bg:"secondaryLight",px:4,py:3,borderBottomWidth:1,children:"FORMULE LIBERT\xc9 PAC"}),(0,r.jsx)(l.x,{fontSize:"sm",fontWeight:"bold",px:4,py:3,textAlign:"center",borderBottomWidth:1,children:"14,90 €/mois soit 178,80 €/an"}),(0,r.jsxs)(w.g,{px:4,py:2,align:"stretch",children:[(0,r.jsxs)(y.U,{spacing:5,children:[(0,r.jsx)(S.Z,{zoom:!1,w:"20px",minW:"20px"}),(0,r.jsx)(l.x,{w:"full",children:"Visite d'entretien annuel"})]}),(0,r.jsxs)(s.k,{mt:2,children:[(0,r.jsx)(S.Z,{zoom:!1,w:"20px",minW:"20px",mt:"6px",mr:5}),(0,r.jsx)(l.x,{w:"full",verticalAlign:"top",children:"Lors du 1er d\xe9pannage b\xe9n\xe9ficiez de 20% de r\xe9duction sur les pi\xe8ces"})]})]})]})}),(0,r.jsxs)(i.xu,{w:"50%",children:[(0,r.jsx)(l.x,{fontSize:"2xl",fontWeight:"bold",children:"Changement de formule"}),(0,r.jsx)(l.x,{mt:5,children:'Compte tenu de l\'anciennet\xe9 de votre \xe9quipement, nous ne sommes pas en mesure de vous proposer la formule "S\xe9curit\xe9".'}),(0,r.jsx)(l.x,{my:3,children:"Nous vous sugg\xe9rons de poursuivre avec la Formule Libert\xe9, qui est la plus proche de la Formule S\xe9curit\xe9."}),(0,r.jsxs)(w.g,{spacing:4,w:"full",mt:5,children:[(0,r.jsx)(R.default,{w:"full",onClick:()=>{c()},fontSize:16,href:"/services/contrat-entretien?type=liberte",children:"Continuer avec la formule Libert\xe9"}),(0,r.jsx)(l.x,{as:K.default,href:"/services/entretien-maintenance#offres",onClick:c,fontWeight:600,children:"Choisir une autre formule"})]})]})]})})}),ea=n(59772),ed=n(67016),eu=n(4566);function ex(e){let{data:t,isLoading:n}=function(){let e=(0,Z.useSearchParams)(),[t,n]=(0,x.useState)(),[r,i]=(0,x.useState)(!0),s=(0,Z.useRouter)(),o=(0,x.useMemo)(()=>e.get("type"),[e]),l=(0,x.useMemo)(()=>{let t=e.get("produits");return t?t.split(","):["1"]},[e]);return(0,x.useEffect)(()=>{(async()=>{try{let e=await (0,X.QT)((0,X.JU)(N.db,"maintenance_forms",o||"default"));e.exists()&&n(e.data())}catch(r){n(void 0);let e="/services/contrat-entretien?type=".concat(o||"","&produits=").concat(l.join(",")||""),t="/app/connexion?redirect=".concat(encodeURIComponent(e));s.push(t)}i(!1)})()},[]),{isLoading:r,data:t}}(),{data:o}=(0,eu.Pi)(),l=(0,x.useRef)(null),c=(0,Z.useRouter)(),a=(0,T.w5)({schema:ea.z.any()}),[d,p]=(0,x.useState)(0),m=(0,x.useMemo)(()=>null==t?void 0:t.tree[d],[null==t?void 0:t.tree,d]);if((0,x.useEffect)(()=>{o&&a.reset({"code-postal":o.address.zipCode,email:o.email,nom:o.lastName,prenom:o.firstName,adresse:o.address})},[o]),n||!t)return(0,r.jsx)(ed.Z,{minH:"80vh",children:"Chargement du formulaire..."});let{products:f,totalPrice:g,type:j}=t;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(T.l0,{form:a,children:[(0,r.jsx)(u,{step:d,type:j,onChangeStep:p}),(0,r.jsxs)(i.xu,{position:"relative",py:10,px:5,children:[(0,r.jsxs)(s.k,{flexDir:{base:"column",lg:"row"},justifyContent:"center",alignItems:{base:"center",lg:"unset"},scrollMarginTop:"100px",id:"formulaire",children:[(0,r.jsx)(es,{currentTree:m,onNext:function(e){var n,r,i;let s=null!==(r=null===(n=m.dependencies)||void 0===n?void 0:n[t.type.type])&&void 0!==r?r:{},o="";if(Object.entries(s).forEach(t=>{let[n,r]=t;if(e[n]==r.ifValue){o=r.type;return}}),"modal-change-type-to-liberte"===o){null===(i=l.current)||void 0===i||i.onOpen();return}p(e=>e+1),c.push("#formulaire")},products:f,contractType:j.type,onPrevious:d>0&&6!=d?()=>{p(e=>e-1)}:void 0}),(0,r.jsx)(b,{contractLabel:j.label,products:f,totalPrice:g})]}),(0,r.jsx)(h,{})]})]}),(0,r.jsx)(ec,{ref:l})]})}}},function(e){e.O(0,[351,897,335,744],function(){return e(e.s=67342)}),_N_E=e.O()}]);